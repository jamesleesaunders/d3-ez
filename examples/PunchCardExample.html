<!DOCTYPE html>
<html>

  <head>
    <title>d3-ez : Punch Card Example</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="../dist/d3-ez.js"></script>
    <link rel="stylesheet" type="text/css" href="../dist/d3-ez.css"/>
  </head>

  <body>
    <svg id="chartholder"></svg>
    <br/>
    <div>Value: <span id="message"></span></div>

    <script type="text/javascript">
      d3.json("data/netflix_isp_speed_index.json").then(function(json) {
        // Netflix Speed ISP Speed Index Source: https://ispspeedindex.netflix.com/country/uk/

        // Convert json to d3-ez data format
        var data = d3.nest().key(function(d) {
          return d.ISP;
        }).entries(json.Data).map(function(obj) {
          obj.values = obj.values.map(function(values) {
            return {
              key: values.Month,
              value: values.Value
            };
          });
          return obj;
        });

        // Create chart base
        var myChart = d3.ez.chart.punchCard()
          .width(1000)
          .height(600)
          .on("customValueMouseOver", function(e, d) {
            console.log(d)
            d3.select("#message").text(d);
          })
          .on("customSeriesClick", function(e, d) {
            console.log(d);
          });

        d3.select('#chartholder')
          .datum(data)
          .call(myChart);
      });
    </script>
  </body>

</html>
